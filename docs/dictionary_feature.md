# 英语词典功能说明

## 概述

DF-OCR工具现在支持英语词典查询功能！在识别游戏文本的同时，系统会自动查询ECDICT英语词典，帮助您理解不熟悉的英语单词。

## 功能特点

### 1. 双重查询系统
- 📖 **DF Wiki词条**：游戏相关的专业术语和概念
- 📚 **英语词典**：通用英语单词和短语

两种查询结果会同时显示在结果窗口中，方便您快速找到需要的信息。

### 2. 智能词形还原
系统会自动识别单词的变形，并查询其原型：
- `running` → `run`
- `goes` → `go`
- `babies` → `baby`
- `walked` → `walk`

### 3. 丰富的词典信息
每个单词包含：
- 🔊 **音标**：英式/美式发音
- 📖 **中文释义**：详细的中文翻译
- 📝 **英文定义**：英文解释
- 🏷️ **词性**：名词、动词等
- ⭐ **柯林斯星级**：标注单词常用程度
- 📚 **牛津词汇标记**：标注是否为核心词汇
- 🔄 **词形变化**：列出所有变形（过去式、复数等）
- 📜 **词源**：单词的来源和历史

### 4. 视觉区分
- Wiki词条按钮显示 📖 图标，选中时为**绿色**
- 词典单词按钮显示 📚 图标，选中时为**蓝色**

## 安装步骤

### 1. 下载ECDICT数据库

运行下载脚本：
```bash
python scripts/download_ecdict.py
```

**或者手动下载：**
1. 访问 https://github.com/skywind3000/ECDICT/releases
2. 下载最新的 `ecdict-sqlite-XX.zip`（约150MB）
3. 解压后将 `.db` 文件重命名为 `ecdict.db`
4. 放置在项目根目录（与 `src/` 文件夹同级）

### 2. 验证安装

启动应用后，如果词典数据库存在，查询结果中就会包含词典单词。

如果数据库文件不存在，应用仍然可以正常工作（仅Wiki查询功能）。

## 使用示例

### 场景1：识别游戏UI文本
假设OCR识别到：`"Dwarf running workshop"`

**结果显示：**
- 📖 Dwarf (Wiki词条) - 游戏中的矮人种族介绍
- 📚 running (词典) - run的现在分词，跑步、运行
- 📖 Workshop (Wiki词条) - 游戏中的工坊建筑

### 场景2：阅读游戏描述
OCR识别到：`"These creatures live underground"`

**结果显示：**
- 📚 creatures (词典) - creature的复数，生物、造物
- 📚 live (词典) - 居住、生活
- 📚 underground (词典) - 地下的、地下空间

## 技术细节

### ECDICT数据库
- **来源**：https://github.com/skywind3000/ECDICT
- **规模**：150万+ 英文单词和短语
- **格式**：SQLite 数据库
- **许可**：MIT License

### 词形还原规则
应用使用内置的词形还原算法，支持：
- 规则动词变形（-ed, -ing）
- 名词复数（-s, -es, -ies）
- 比较级和最高级（-er, -est）
- 不规则动词需要数据库中的lemma字段支持

### 查询性能
- 数据库使用索引优化查询
- 单词查询耗时 < 10ms
- 多线程不会阻塞UI

## 常见问题

### Q: 词典数据库必须安装吗？
A: 不是必须的。如果不安装，应用仍然可以正常使用Wiki查询功能。

### Q: 数据库文件很大怎么办？
A: 解压后约450MB，主要是因为包含150万+词条。如果磁盘空间有限，可以不安装此功能。

### Q: 能否使用其他词典？
A: 理论上可以，但需要修改 `src/dictionary.py` 中的数据库查询逻辑。ECDICT采用的表结构为 `stardict`。

### Q: 词典支持中英切换吗？
A: 词典内容本身就是中英双语的，因此不需要切换。语言切换按钮仅对Wiki词条有效。

### Q: 如何知道词典功能是否正常工作？
A: 查询任何包含常见英语单词的文本，结果窗口应该会显示带 📚 图标的词典单词按钮。

## 未来改进计划

- [ ] 支持单词收藏夹
- [ ] 添加词频统计
- [ ] 支持例句显示
- [ ] 集成发音功能（TTS）
- [ ] 支持离线翻译API集成
